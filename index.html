<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALTHEA | V23.1 PRODUCTION</title>
    <style>
        body { background: #000; color: #0f0; font-family: 'Courier New', monospace; padding: 20px; overflow-x: hidden; }
        .terminal { background: #050505; border: 1px solid #333; height: 250px; overflow-y: auto; padding: 10px; font-size: 0.8em; box-shadow: inset 0 0 15px #000; margin-bottom: 10px; }
        .status-bar { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; padding: 10px; border: 1px solid #222; background: #080808; }
        #statusLight { width: 12px; height: 12px; border-radius: 50%; background: #300; transition: 0.3s; box-shadow: 0 0 5px #300; }
        .uplink-zone { border: 2px dashed #0f0; padding: 30px; text-align: center; cursor: pointer; display: block; transition: 0.3s; margin-bottom: 20px; }
        .uplink-zone:hover { background: #001100; box-shadow: 0 0 15px #0f0; }
        #previewContainer { border-top: 1px solid #333; padding-top: 15px; display: none; }
        iframe { width: 100%; height: 250px; border: 1px solid #111; background: #000; }
        .launch-btn { width: 100%; padding: 18px; background: #111; color: #444; border: 1px solid #333; font-weight: bold; cursor: not-allowed; margin-top: 10px; font-size: 1.1em; }
        .active-btn { background: #0f0 !important; color: #000 !important; cursor: pointer !important; box-shadow: 0 0 20px #0f0; }
        input[type="file"] { display: none; }
        .label-text { color: #555; font-size: 0.7em; text-transform: uppercase; }
    </style>
</head>
<body>
    <h1 style="margin-bottom:5px;">ALTHEA ROUTER [PRODUCTION]</h1>
    <div class="label-text">Nexus Bridge v23.1 // Real GitHub Direct</div>
    
    <div class="terminal" id="term">
        <div>system@althea:~$ boot --production-sync</div>
    </div>

    <div class="status-bar">
        <div id="statusLight"></div>
        <span id="statusText" style="color: #444;">IDLE: AWAITING VESSEL...</span>
    </div>

    <label class="uplink-zone" id="dropZone">
        <span>[+] UPLINK / SCAN FILE</span>
        <input type="file" id="fileInput" onchange="initiateScan(this)">
    </label>

    <div id="previewContainer">
        <div class="label-text" style="margin-bottom:5px;">Live Vessel Preview (Cloud Source):</div>
        <iframe id="vesselFrame"></iframe>
        <button id="launchBtn" class="launch-btn" onclick="startLaunch()">EXECUTE LAUNCH SEQUENCE</button>
    </div>

    <script>
        const term = document.getElementById('term');
        const light = document.getElementById('statusLight');
        const sText = document.getElementById('statusText');
        const btn = document.getElementById('launchBtn');
        let finalPath = "";

        function log(msg, color = "#0f0") {
            const time = new Date().toLocaleTimeString().split(' ')[0];
            term.innerHTML += `<div><span style="color:#333">[${time}]</span> <span style="color:${color}">${msg}</span></div>`;
            term.scrollTop = term.scrollHeight;
        }

        // CONSOLE MIRROR: Listens for "Voice" from hook.html or test.html [cite: 2026-01-14]
        window.addEventListener('message', (e) => {
            if (e.data.type === 'vessel_log') {
                log(`[VESSEL]: ${e.data.msg}`, "cyan");
            }
        });

        function initiateScan(input) {
            const file = input.files[0];
            if (!file) return;

            // CORRECTED PATH: Points to the /apps/ subfolder verified via PC
            const safeName = encodeURIComponent(file.name);
            const cloudURL = `https://cbash000-cmd.github.io/Chrome_door/apps/${safeName}`;
            
            log(`Probing Path: /apps/${file.name}...`, "#aaa");
            document.getElementById('previewContainer').style.display = "block";
            const frame = document.getElementById('vesselFrame');
            frame.src = cloudURL;

            frame.onload = () => {
                // If frame loads, we assume success unless 404 is visible
                light.style.background = "#0f0";
                light.style.boxShadow = "0 0 15px #0f0";
                sText.innerText = "ONLINE: HANDSHAKE SUCCESS";
                sText.style.color = "#0f0";
                btn.classList.add('active-btn');
                btn.innerText = "EXECUTE LAUNCH SEQUENCE";
                log("Cloud Handshake Confirmed.");
            };

            // PROTOCOL: Forces the Chrome engine to take over [cite: 2026-01-13]
            finalPath = "googlechrome://" + cloudURL.replace("https://", "");
        }

        function startLaunch() {
            if (!finalPath) return;
            log("CRITICAL: Initializing Local Handoff...", "#fff");
            log("Routing to Chrome Engine...", "#0f0");
            setTimeout(() => { window.location.href = finalPath; }, 1200);
        }
    </script>
</body>
</html>
