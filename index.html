<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALTHEA NEXUS | V25.0</title>
    <style>
        :root { --neon-green: #0f0; --dark-bg: #000; --panel-bg: #0a0a0a; }
        body { background: var(--dark-bg); color: var(--neon-green); font-family: 'Courier New', monospace; margin: 0; padding: 15px; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .terminal { background: #050505; border: 1px solid #333; height: 150px; overflow-y: auto; padding: 10px; font-size: 12px; margin-bottom: 10px; }
        .status-row { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; font-size: 0.8em; }
        #statusLight { width: 10px; height: 10px; border-radius: 50%; background: #300; }
        .portal-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; flex-grow: 1; min-height: 0; }
        .panel { display: flex; flex-direction: column; border: 1px solid #222; background: var(--panel-bg); }
        .panel-header { padding: 5px; font-size: 10px; background: #111; border-bottom: 1px solid #222; display: flex; justify-content: space-between; }
        textarea { flex-grow: 1; background: transparent; color: var(--neon-green); border: none; padding: 10px; resize: none; font-size: 11px; outline: none; }
        iframe { flex-grow: 1; background: #fff; border: none; }
        .controls { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; margin-top: 10px; }
        button { background: #111; color: var(--neon-green); border: 1px solid var(--neon-green); padding: 10px; cursor: pointer; font-size: 10px; font-weight: bold; }
        button:hover { background: var(--neon-green); color: #000; }
        .btn-glow { box-shadow: 0 0 10px var(--neon-green); }
        #fileInputLabel { background: #111; color: cyan; border: 1px dashed cyan; text-align: center; padding: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="status-row">
        <div id="statusLight"></div>
        <span id="statusText">SYSTEM READY: AWAITING UPLINK</span>
    </div>

    <div class="terminal" id="term"><div>[NEXUS BOOT COMPLETE]</div></div>

    <label id="fileInputLabel">
        [+] SCAN LOCAL VESSEL (IMITATION MODE)
        <input type="file" id="fileInput" style="display:none" onchange="loadVessel(this)">
    </label>

    <div class="portal-grid">
        <div class="panel">
            <div class="panel-header"><span>CODE INSPECTOR</span><span id="fileName">---</span></div>
            <textarea id="codeEditor" spellcheck="false" placeholder="Vessel code will manifest here..."></textarea>
        </div>
        <div class="panel">
            <div class="panel-header"><span>PORTAL VIEW</span><span id="fpsCounter">0 FPS</span></div>
            <iframe id="vesselFrame" sandbox="allow-scripts allow-forms allow-modals"></iframe>
        </div>
    </div>

    <div class="controls">
        <button onclick="applyChanges()" class="btn-glow">APPLY CHANGES</button>
        <button onclick="saveFile()">SAVE TO DEVICE</button>
        <button onclick="pushToChrome()" style="border-color:cyan; color:cyan;">PUSH TO CHROME</button>
    </div>

    <script>
        const log = (m) => { const d = document.getElementById('term'); d.innerHTML += `<div>> ${m}</div>`; d.scrollTop = d.scrollHeight; };
        let currentCloudURL = "";

        // Capture Telemetry from Vessel [cite: 2026-01-14]
        window.addEventListener('message', (e) => {
            if (e.data.type === 'vessel_log') {
                log(`<span style="color:cyan">[TELEMETRY]:</span> ${e.data.msg}`);
                if(e.data.msg.includes("fps")) document.getElementById('fpsCounter').innerText = e.data.msg;
            }
        });

        function loadVessel(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('codeEditor').value = e.target.result;
                document.getElementById('fileName').innerText = file.name;
                currentCloudURL = `cbash000-cmd.github.io/Chrome_door/apps/${encodeURIComponent(file.name)}`;
                applyChanges();
                log(`Vessel ${file.name} loaded into Portal.`);
            };
            reader.readAsText(file);
        }

        function applyChanges() {
            const content = document.getElementById('codeEditor').value;
            const blob = new Blob([content], { type: 'text/html' });
            const frame = document.getElementById('vesselFrame');
            if(frame.src) URL.revokeObjectURL(frame.src);
            frame.src = URL.createObjectURL(blob);
            document.getElementById('statusLight').style.background = '#0f0';
            document.getElementById('statusText').innerText = "ONLINE: IMITATION ACTIVE";
            log("Nexus Injection Refreshed.");
        }

        function saveFile() {
            const content = document.getElementById('codeEditor').value;
            const blob = new Blob([content], { type: 'text/html' });
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "ALTHEA_UPDATE_" + document.getElementById('fileName').innerText;
            link.click();
            log("System Export Triggered.");
        }

        function pushToChrome() {
            if(!currentCloudURL) return log("ERROR: No Cloud Path Defined");
            log("Initiating Chrome Deep-Link...");
            setTimeout(() => { window.location.href = "googlechrome://" + currentCloudURL; }, 1000);
        }
    </script>
</body>
</html>
